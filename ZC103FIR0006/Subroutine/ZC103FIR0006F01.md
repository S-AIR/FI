``` abap
*&---------------------------------------------------------------------*
*& Include          ZC103FIR0006F01
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*& Form display_screen
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM display_screen .

  IF go_container IS NOT BOUND.

    CLEAR : gt_fcat, gs_fcat.

    PERFORM set_field_catalog USING :   'X' 'GJAHR'          'ZC103FIT0001'   'C' ' ',
                                        'X' 'BELNR'          'ZC103FIT0001'   'C' ' ',
                                        ' ' 'BP_NAME'        'ZC103FIT0001'   ' ' 'X',
                                        ' ' 'BUDAT'          'ZC103FIT0001'   'C' ' ',
                                        ' ' 'ENDAT'          ' '   'C' ' ',
                                        ' ' 'OVERDUE'        ' '   ' '  ' ',
                                        ' ' 'BKTXT'         'ZC103FIT0001'   ' ' ' ',
                                        ' ' 'WRBTR'         'ZC103FIT0002'   ' ' ' ',
                                        ' ' 'WAERS'         'ZC103FIT0002'   'C' ' '.

    PERFORM set_layout.
    PERFORM exclude_toolbar.
    PERFORM create_object.
    PERFORM register_tree_event.
    PERFORM build_node.

    CALL METHOD go_tree->add_nodes
      EXPORTING
        table_structure_name = 'MTREESNODE'
        node_table           = node_table.

    CALL METHOD go_tree->expand_node
      EXPORTING
        node_key = 'ROOT'.

    SET HANDLER : lcl_event_handler=>hotspot_click  FOR go_alv_grid, " Instance me
                  lcl_event_handler=>edit_toolbar FOR go_alv_grid,
                  lcl_event_handler=>user_command FOR go_alv_grid,
                  lcl_event_handler=>hotspot_click         FOR go_alv_grid.

**-- Display TOP ALV

    CALL METHOD go_alv_grid->set_table_for_first_display
      EXPORTING
        is_variant           = gs_variant
        i_save               = 'A'
        i_default            = 'X'
        is_layout            = gs_layout
        it_toolbar_excluding = gt_ui_functions
      CHANGING
        it_outtab            = gt_header
        it_fieldcatalog      = gt_fcat
        it_sort              = gt_sort.

  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form set_field_catalog
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*&      --> P_
*&      --> P_
*&      --> P_
*&      --> P_
*&      --> P_
*&---------------------------------------------------------------------*
FORM set_field_catalog  USING pv_key pv_field pv_table pv_just pv_emph.

  gs_fcat-key       = pv_key.
  gs_fcat-fieldname = pv_field.
  gs_fcat-ref_table = pv_table.
  gs_fcat-just      = pv_just.
  gs_fcat-emphasize = pv_emph.

  CASE pv_field.
    WHEN 'GJAHR'.
      gs_fcat-coltext = '회계연도'.
    WHEN 'BELNR'.
      gs_fcat-coltext = '전표번호'.
      gs_fcat-hotspot = 'X'.
    WHEN 'BUDAT'.
      gs_fcat-coltext = '빌링일자'.
    WHEN 'ENDAT'.
      gs_fcat-coltext = '마감일자'.
    WHEN 'OVERDUE'.
      gs_fcat-coltext = '연체일수'.
    WHEN 'BKTXT'.
      gs_fcat-coltext = '헤더텍스트'.
    WHEN 'WRBTR'.
      gs_fcat-cfieldname = 'WAERS'.
      gs_fcat-coltext = '전표통화금액'.
      "gs_fcat-do_sum     = abap_true. " All total
    WHEN 'WAERS'.
      gs_fcat-coltext = '전표통화'.
  ENDCASE.

  APPEND gs_fcat TO gt_fcat.
  CLEAR gs_fcat.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form set_layout
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM set_layout .

*-- Set Layout
  gs_layout-zebra      = abap_true.
  gs_layout-cwidth_opt = 'A'.
  gs_layout-sel_mode   = 'D'. "edit mode
  gs_layout-totals_bef = abap_true. " Total line : First display
  gs_layout-grid_title = '지급독촉 거래내역'.
  gs_layout-ctab_fname  = 'COLOR'. " Assignment color manager

*-- Set ALV Layout
  gs_variant-report = sy-repid.
  gs_variant-handle = 'ALV1'.

*-- Set Sort
  CLEAR : gt_sort, gs_sort.

  " 첫 번째 정렬: GJAHR
  gs_sort-spos      = 1.
  gs_sort-fieldname = 'GJAHR'.
  gs_sort-up        = abap_true.
  APPEND gs_sort TO gt_sort.

  CLEAR gs_sort.

  " 두 번째 정렬: BELNR
  gs_sort-spos      = 2.
  gs_sort-fieldname = 'BELNR'.
  gs_sort-up        = abap_true.
  gs_sort-subtot    = abap_true.
  APPEND gs_sort TO gt_sort.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form exclude_toolbar
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM exclude_toolbar .

  DATA : ls_ui_functions TYPE ui_func.

* 툴바에서 제외시킬것들을 담음.
  ls_ui_functions = cl_gui_alv_grid=>mc_fc_loc_undo.
  APPEND ls_ui_functions TO gt_ui_functions.
  ls_ui_functions = cl_gui_alv_grid=>mc_fc_loc_copy.
  APPEND ls_ui_functions TO gt_ui_functions.
  ls_ui_functions = cl_gui_alv_grid=>mc_fc_loc_copy_row.
  APPEND ls_ui_functions TO gt_ui_functions.
  ls_ui_functions = cl_gui_alv_grid=>mc_fc_loc_cut.
  APPEND ls_ui_functions TO gt_ui_functions.
  ls_ui_functions = cl_gui_alv_grid=>mc_fc_loc_delete_row.
  APPEND ls_ui_functions TO gt_ui_functions.
  ls_ui_functions = cl_gui_alv_grid=>mc_fc_loc_insert_row.
  APPEND ls_ui_functions TO gt_ui_functions.
  ls_ui_functions = cl_gui_alv_grid=>mc_fc_loc_append_row.
  APPEND ls_ui_functions TO gt_ui_functions.
  ls_ui_functions = cl_gui_alv_grid=>mc_fc_loc_paste.
  APPEND ls_ui_functions TO gt_ui_functions.
  ls_ui_functions = cl_gui_alv_grid=>mc_fc_loc_paste_new_row.
  APPEND ls_ui_functions TO gt_ui_functions.
  ls_ui_functions = cl_gui_alv_grid=>mc_fc_refresh.
  APPEND ls_ui_functions TO gt_ui_functions.
  ls_ui_functions = cl_gui_alv_grid=>mc_fc_auf.
  APPEND ls_ui_functions TO gt_ui_functions.
  ls_ui_functions = cl_gui_alv_grid=>mc_fc_average.
  APPEND ls_ui_functions TO gt_ui_functions.
  ls_ui_functions = cl_gui_alv_grid=>mc_fc_print.
  APPEND ls_ui_functions TO gt_ui_functions.
  ls_ui_functions = cl_gui_alv_grid=>mc_fc_graph.
  APPEND ls_ui_functions TO gt_ui_functions.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form create_object
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM create_object .

  " 1. Main Docking Container (왼쪽 도킹)
  CREATE OBJECT go_container
    EXPORTING
      side      = cl_gui_docking_container=>dock_at_left
      extension = 5000.

  " 2. Splitter: 좌/우
  CREATE OBJECT go_split_cont
    EXPORTING
      parent  = go_container
      rows    = 1
      columns = 2.

  " 3. 좌측 컨테이너 → 트리 + 트리 ALV
  CALL METHOD go_split_cont->get_container
    EXPORTING
      row       = 1
      column    = 1
    RECEIVING
      container = go_left_cont.

  CREATE OBJECT go_tree
    EXPORTING
      parent              = go_left_cont
      node_selection_mode = cl_gui_simple_tree=>node_sel_mode_single.

  CALL METHOD go_split_cont->set_column_width
    EXPORTING
      id    = 1 " Column ID
      width = 15. " Width

  CREATE OBJECT go_tree_grid
    EXPORTING
      i_parent = go_left_cont.

  " 4. 우측 컨테이너 → 다시 Splitter 구성
  CALL METHOD go_split_cont->get_container
    EXPORTING
      row       = 1
      column    = 2
    RECEIVING
      container = go_right_cont.  " 이건 cl_gui_container 타입임, docking은 위에서 쓰지 않음
  "5. 우측 내부 splitter
  CREATE OBJECT go_right_split_cont
    EXPORTING
      parent  = go_right_cont
      rows    = 1
      columns = 2.

  " 6. 우측 내부 좌/우 컨테이너
  CALL METHOD go_right_split_cont->get_container
    EXPORTING
      row       = 1
      column    = 1
    RECEIVING
      container = go_right_left_cont.

  CALL METHOD go_right_split_cont->get_container
    EXPORTING
      row       = 1
      column    = 2
    RECEIVING
      container = go_right_right_cont.

  " 7. ALV 생성 (왼쪽 영역)
  CREATE OBJECT go_alv_grid
    EXPORTING
      i_parent = go_right_left_cont.

  CREATE OBJECT go_chart
    EXPORTING
      parent = go_right_right_cont.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form handel_hotspot_click
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*&      --> E_ROW_ID
*&      --> E_COLUMN_ID
*&---------------------------------------------------------------------*
FORM handel_hotspot_click  USING pv_row pv_column.

  DATA lv_txt50(10).

*-- 선택한 행의 Data를 읽는다.
  CLEAR gs_header.
  READ TABLE gt_header INTO gs_header INDEX pv_row.

*-- 선택한 전표의 개별항목(상세내역)을 BSEG 테이블로부터 조회한다.
  CLEAR gt_item.
  SELECT bukrs belnr gjahr buzei wrbtr waers shkzg k_waers hkont sgtxt
    INTO CORRESPONDING FIELDS OF TABLE gt_item
    FROM zc103fit0002
    WHERE bukrs EQ gs_header-bukrs
      AND belnr EQ gs_header-belnr
      AND gjahr EQ gs_header-gjahr.

  LOOP AT gt_item INTO gs_item.
    lv_txt50 = gs_item-hkont.
    READ TABLE gt_03 INTO DATA(ls_03) WITH KEY saknr = lv_txt50.
    IF sy-subrc = 0.
      gs_item-txt50 = ls_03-txt50.
    ENDIF.
    MODIFY gt_item FROM gs_item.
  ENDLOOP.

*-- 조회된 Data를 Popup screen으로 출력한다.
  CALL SCREEN 110 STARTING AT 15 05 ENDING AT 100 10.

ENDFORM.

*&---------------------------------------------------------------------*
*& Form set_init_value
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM set_init_value .

*  PERFORM get_itab USING ' '.

  SELECT saknr txt50
  INTO CORRESPONDING FIELDS OF TABLE gt_03
  FROM zc103fit0003.

  SELECT empno dptcode empname telno email
  INTO CORRESPONDING FIELDS OF TABLE gt_11
    FROM zc103fit0011.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form handle_edit_toolbar
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*&      --> E_OBJECT
*&      --> E_INTERACTIVE
*&---------------------------------------------------------------------*
FORM handle_edit_toolbar  USING po_object TYPE REF TO cl_alv_event_toolbar_set
                                pv_interactive.

  CLEAR gs_button.
  gs_button-butn_type = '3'.
  APPEND gs_button TO po_object->mt_toolbar.

  CLEAR gs_button.
  gs_button-function  = 'READ_DUNNING'.
  gs_button-icon      = icon_mail.
  gs_button-quickinfo = 'read_dunning'.
  gs_button-text = ' 독촉장 보기 '.
  APPEND gs_button TO po_object->mt_toolbar.

  CLEAR gs_button.
  gs_button-function  = 'SEND_MAIL'.
  gs_button-icon      = icon_mail.
  gs_button-quickinfo = 'send mail'.
  gs_button-text = ' 독촉장 보내기 '.
  APPEND gs_button TO po_object->mt_toolbar.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form handle_user_command
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*&      --> E_UCOMM
*&---------------------------------------------------------------------*
FORM handle_user_command  USING pv_ucomm.

  CASE pv_ucomm.
    WHEN 'READ_DUNNING'.
      PERFORM read_dunning.
    WHEN 'SEND_MAIL'.
      PERFORM send_mail.
  ENDCASE.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form send_mail
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM read_dunning .

  DATA: lt_html      TYPE STANDARD TABLE OF string,
        lv_file_path TYPE string,
        lv_url       TYPE c LENGTH 255.

  IF gt_header IS INITIAL.
    MESSAGE '독촉할 데이터가 없습니다' TYPE 'S' DISPLAY LIKE 'E'.
    RETURN.
  ENDIF.

  PERFORM create_ticket_html CHANGING lt_html.

  " HTML 파일 저장
  lv_file_path = |C:/temp/eticket_{ sy-datum }.html|.
  lv_url = |file:///C:/temp/eticket_{ sy-datum }.html|.

  CALL METHOD cl_gui_frontend_services=>gui_download
    EXPORTING
      filename = lv_file_path
      filetype = 'ASC'
    CHANGING
      data_tab = lt_html.

  " 팝업 컨테이너
  " 1. 팝업 컨테이너 생성
  IF go_popup_container IS INITIAL.
    CREATE OBJECT go_popup_container
      EXPORTING
        caption                 = '독촉장 미리보기'
        top                     = 100
        left                    = 100
        width                   = 1200
        height                  = 550
        no_autodef_progid_dynnr = 'X'. " 추가 옵션
  ENDIF.

  " 2. HTML 뷰어 생성
  IF go_html_view IS INITIAL.
    CREATE OBJECT go_html_view
      EXPORTING
        parent = go_popup_container.
  ENDIF.

  SET HANDLER lcl_event_handler=>on_close FOR go_popup_container.

  " 3. 파일 저장 경로 설정
  lv_file_path = |C:/Users/soldesk/Desktop/tickets/E-ticket_{ gs_header-bp_id }_{ sy-datum }.html|.
  lv_url       = |file:///C:/Users/soldesk/Desktop/tickets/E-ticket_{ gs_header-bp_id }_{ sy-datum }.html|.

  " 4. HTML 파일 저장
  CALL METHOD cl_gui_frontend_services=>gui_download
    EXPORTING
      filename         = lv_file_path
      filetype         = 'ASC'
    CHANGING
      data_tab         = lt_html
    EXCEPTIONS
      access_denied    = 1
      file_write_error = 2
      OTHERS           = 3.

  IF sy-subrc <> 0.
    MESSAGE '파일 저장 실패: 권한 또는 경로 오류' TYPE 'E'.
    RETURN.
  ENDIF.

  " 5. HTML 표시
  CALL METHOD go_html_view->show_url
    EXPORTING
      url = lv_url.
*
*  DATA: lt_html      TYPE STANDARD TABLE OF string,
*        lv_file_path TYPE string,
*        lv_url       TYPE string.
*
*  PERFORM create_ticket_html USING '' '' CHANGING lt_html.
*
*  lv_file_path = |C:/Users/soldesk/Desktop/tickets/E-ticket_{ gs_header-bp_id }_{ sy-datum }.html|.
*  lv_url = |file:///C:/Users/soldesk/Desktop/tickets/E-ticket_{ gs_header-bp_id }_{ sy-datum }.html|.
*
*  CALL METHOD cl_gui_frontend_services=>gui_download
*    EXPORTING
*      filename = lv_file_path
*      filetype = 'ASC'
*    CHANGING
*      data_tab = lt_html.
*
*  " 전역변수에 URL 저장 후 CALL SCREEN
*  gv_html_url = lv_url.  " 전역변수에 저장해둡니다
*
*  CALL SCREEN 120 STARTING AT 15 05 ENDING AT 100 25.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form register_tree_event
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM register_tree_event .

  event-eventid = cl_gui_simple_tree=>eventid_node_double_click.
  event-appl_event = 'X'.
  APPEND event TO events.

  CALL METHOD go_tree->set_registered_events
    EXPORTING
      events                    = events
    EXCEPTIONS
      cntl_error                = 1
      cntl_system_error         = 2
      illegal_event_combination = 3
      OTHERS                    = 4.

  IF sy-subrc <> 0.
    MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
               WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
  ENDIF.

  SET HANDLER lcl_event_handler=>node_double_click FOR go_tree.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form build_node
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM build_node .

  DATA: ls_node      TYPE mtreesnode.

  ls_node-node_key   = 'ROOT'.
  ls_node-text       = 'Business Partner'.
  ls_node-isfolder   = 'X'.
  ls_node-n_image    = '@06@'.   " 접은 이미지
  ls_node-exp_image  = '@07@'.   " 펼친 이미지
  APPEND ls_node TO node_table.
  CLEAR ls_node.

  " BP Type 노드 -> 중복없이 한 번씩만
  LOOP AT gt_bptype INTO gs_bptype.

    ls_node-node_key   = gs_bptype-bptype.
    ls_node-relatkey   = 'ROOT'.
    ls_node-text       = gs_bptype-bptypename.
    ls_node-isfolder   = 'X'.
    ls_node-n_image    = '@54@'.   " 접은 이미지
    ls_node-exp_image  = '@55@'.   " 펼친 이미지
    APPEND ls_node TO node_table.
    CLEAR: ls_node, gs_bptype.

  ENDLOOP.

  LOOP AT gt_tree INTO gs_tree.

    ls_node-node_key  = gs_tree-bpid.
    ls_node-relatkey  = gs_tree-bptype.
    ls_node-isfolder  = ' '.
    ls_node-text      = gs_tree-bpname.
    APPEND ls_node TO node_table.
    CLEAR: ls_node, gs_tree.

  ENDLOOP.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form handle_node_double_click
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*&      --> NODE_KEY
*&---------------------------------------------------------------------*
FORM handle_node_double_click  USING pv_node_key.

  DATA : lv_all          TYPE string,
         lv_type         TYPE string,
         lv_id           TYPE string,
         lv_payment_term TYPE zc103sdt0001-paymentterm,
         lv_payment_int  TYPE i,
         lv_bptype       TYPE zc103sdt0001-bptype.

  CLEAR : lv_all, lv_type, lv_id.

  " 데이터 수정하고 처음으로 node를 클릭할 때는 수정된 데이터 반영되도록 DB 다시 접근

  " Set variables
  IF pv_node_key EQ 'ROOT'.      " 최상위 노드(root) 클릭
    lv_all = 'Y'.

  ELSEIF pv_node_key(2) EQ 'BP'. " 최하위 노드(bpid) 클릭
    lv_id = pv_node_key.

    PERFORM get_itab USING lv_id.

    READ TABLE gt_tree INTO gs_tree WITH KEY bpid = lv_id.
    gv_selected_bpname = gs_tree-bpname.

    SELECT SINGLE bptype
      INTO lv_bptype
      FROM zc103sdt0001
      WHERE bpid = lv_id.

    SELECT SINGLE paymentterm
      INTO lv_payment_term
      FROM zc103sdt0001
      WHERE bpid = lv_id.

    CASE lv_payment_term.
      WHEN 'T001'.
        lv_payment_int = 0.
      WHEN 'T030'.
        lv_payment_int = 30.
      WHEN 'T060'.
        lv_payment_int = 60.
    ENDCASE.

  ELSE.                          " 중위 노드(bytype) 클릭
    lv_type = pv_node_key.
    CALL METHOD go_tree->expand_node
      EXPORTING
        node_key = pv_node_key.
  ENDIF.

  PERFORM set_itab_value USING lv_payment_int.
  PERFORM refresh_table.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form set_tree_data
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM set_tree_data .

  IF gt_tree IS INITIAL.

    " BP 목록 조회
    SELECT bpid, bpname, bptype
      FROM zc103sdt0001
      ORDER BY bpname ASCENDING
      INTO CORRESPONDING FIELDS OF TABLE @gt_tree.

    IF gt_tree IS INITIAL.
      MESSAGE s003 DISPLAY LIKE 'E'.
      EXIT.
    ENDIF.

  ENDIF.

  " BP 유형 그룹화
  gt_bptype = CORRESPONDING #( gt_tree ).
  SORT gt_bptype BY bptype DESCENDING.
  DELETE ADJACENT DUPLICATES FROM gt_bptype COMPARING bptype.

  LOOP AT gt_bptype ASSIGNING FIELD-SYMBOL(<fs>).

    IF <fs>-bptype EQ 'T'.
      <fs>-bptypename = '여객 BP'.
    ELSE.
      <fs>-bptypename = '화물 BP'.
    ENDIF.

  ENDLOOP.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form parse_data
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM parse_data .

**-- Get Domain Value
*  SELECT
*    FROM dd07v
*    FIELDS domvalue_l, ddtext
*    WHERE domname = 'ZC103D_FI_LAND'
*    INTO CORRESPONDING FIELDS OF TABLE @gt_dd07v.
*
*  LOOP AT gt_header ASSIGNING FIELD-SYMBOL(<fs>).
*
*    <fs>-countrytext = gt_dd07v[ KEY key domvalue_l = <fs>-country ]-ddtext.
*    IF <fs>-bptype EQ 'B'.
*      <fs>-bptypename = '화물 BP'.
*    ELSE.
*      <fs>-bptypename = '여객 BP'.
*    ENDIF.
*
*  ENDLOOP.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form refresh_table
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM refresh_table .

  CALL METHOD go_alv_grid->refresh_table_display.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form count_account_by_category
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM count_account_by_category .

*  CLEAR: gv_cnt_asset, gv_cnt_liability, gv_cnt_capital, gv_cnt_expense, gv_cnt_revenue.
*
*  LOOP AT gt_header INTO gs_header.
*    CASE gs_header-saknr_gr_cd.
*      WHEN '00'. " 자산
*        gv_cnt_asset = gv_cnt_asset + 1.
*      WHEN '01'. " 부채
*        gv_cnt_liability = gv_cnt_liability + 1.
*      WHEN '02'. " 자본
*        gv_cnt_capital = gv_cnt_capital + 1.
*      WHEN '04'. " 비용
*        gv_cnt_expense = gv_cnt_expense + 1.
*      WHEN '03'. " 수익
*        gv_cnt_revenue = gv_cnt_revenue + 1.
*    ENDCASE.
*  ENDLOOP.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form display_chart
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM display_chart .

  CLEAR : go_ixml,
            go_ixml_sf,
            go_ixml_docu,
            go_ixml_ostream,
            go_ixml_encoding,
            go_chartdata,
            go_categories,
            go_category,
            go_series,
            go_point,
            go_value.

  CLEAR : gv_xstring.

  go_ixml = cl_ixml=>create(  ).
  go_ixml_sf = go_ixml->create_stream_factory( ).

  go_ixml_docu = go_ixml->create_document( ).

  go_ixml_encoding = go_ixml->create_encoding(
                       byte_order    = if_ixml_encoding=>co_little_endian
                       character_set = 'utf-8' ).

  go_ixml_docu->set_encoding( encoding = go_ixml_encoding ).

*-- Now build a DOM, representing an XML document with chart data
  go_chartdata = go_ixml_docu->create_simple_element(
                                        name   = 'ChartData'
                                        parent = go_ixml_docu ).

*-- Categories (parent)
  go_categories = go_ixml_docu->create_simple_element(
                                        name   = 'Categories'
                                        parent = go_chartdata ).

  PERFORM set_category_value.
  PERFORM set_chart_value.
  PERFORM design_mode.

  go_chart->set_data( xdata = gv_xstring ).
  go_chart->render( ).

ENDFORM.
*&---------------------------------------------------------------------*
*& Form set_category_value
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM set_category_value .

  DATA: lt_months_raw TYPE STANDARD TABLE OF string WITH EMPTY KEY,
        lt_months     TYPE STANDARD TABLE OF string WITH EMPTY KEY,
        lv_month_text TYPE string,
        lv_month_num  TYPE i,
        lv_year_num   TYPE i,
        lv_loop_idx   TYPE i,
        lv_month_char TYPE c LENGTH 2.

  lv_year_num  = sy-datum+0(4).
  lv_month_num = sy-datum+4(2).

  " 일단 APPEND
  DO 5 TIMES.
    lv_loop_idx = 5 - sy-index.
    lv_month_num = lv_month_num - 1.

    IF lv_month_num <= 0.
      lv_month_num = lv_month_num + 12.
      lv_year_num = lv_year_num - 1.
    ENDIF.

    lv_month_char = lv_month_num.
    CONDENSE lv_month_char.
    CONCATENATE lv_month_char '월' INTO lv_month_text.

    APPEND lv_month_text TO lt_months_raw.
  ENDDO.

  " 수동으로 역순 리스트 만들기
  DATA: lv_idx TYPE i.
  DESCRIBE TABLE lt_months_raw LINES lv_idx.

  WHILE lv_idx > 0.
    READ TABLE lt_months_raw INTO lv_month_text INDEX lv_idx.
    IF sy-subrc = 0.
      APPEND lv_month_text TO lt_months.
    ENDIF.
    lv_idx = lv_idx - 1.
  ENDWHILE.

  " 출력
  LOOP AT lt_months INTO lv_month_text.
    go_category = go_ixml_docu->create_simple_element(
                      name   = 'Category'
                      parent = go_categories ).
    go_category->if_ixml_node~set_value( lv_month_text ).
  ENDLOOP.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form set_chart_value
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM set_chart_value .

  DATA: lt_values      TYPE STANDARD TABLE OF i,
        lv_idx         TYPE i,
        lv_one         TYPE i,
        lv_two         TYPE i,
        lv_three       TYPE i,
        lv_four        TYPE i,
        lv_five        TYPE i,
        lv_month       TYPE i,
        lv_temp        TYPE i,
        lt_temp_header LIKE gt_header,
        ls_temp_header LIKE gs_header.

  CLEAR: lv_idx, lv_one, lv_two, lv_three, lv_four, lv_five, lv_month, lv_temp,
         lt_temp_header, ls_temp_header.

  lt_temp_header = gt_header.

  " 중복 제거를 위해 정렬 (키 필드 순서대로)
  SORT lt_temp_header BY gjahr belnr.

  " 인접 중복 제거 (정렬 후에만 유효)
  DELETE ADJACENT DUPLICATES FROM lt_temp_header COMPARING gjahr belnr.

  LOOP AT lt_temp_header  INTO ls_temp_header.

    lv_month = ls_temp_header-budat+4(2).
    lv_temp = sy-datum+4(2) - lv_month.
    CASE lv_temp.
      WHEN 1.
        lv_one = lv_one + 1.
      WHEN 2.
        lv_two = lv_two + 1.
      WHEN 3.
        lv_three = lv_three + 1.
      WHEN 4.
        lv_four = lv_four + 1.
      WHEN 5.
        lv_five = lv_five + 1.
    ENDCASE.

  ENDLOOP.

  " 예시로 5개월치 값 하드코딩 (실제론 데이터 소스에서 가져와야 함)
  lt_values = VALUE #( ( lv_five ) ( lv_four ) ( lv_three ) ( lv_two ) ( lv_one ) ).

  go_series = go_ixml_docu->create_simple_element(
                                            name  = 'Series'
                                            parent = go_chartdata ).
  go_series->set_attribute( name = 'label' value = gv_selected_bpname && ' 미결건수' ).

  lv_idx = 0.
  LOOP AT lt_values INTO DATA(lv_value).
    lv_idx = lv_idx + 1.

    go_point = go_ixml_docu->create_simple_element(
                                                name = 'Point'
                                                parent = go_series ).
    go_point->set_attribute( name = 'label' value = |{ lv_idx }월| ).

    go_value = go_ixml_docu->create_simple_element(
                                                name = 'Value'
                                                parent = go_point ).
    go_value->if_ixml_node~set_value( |{ lv_value }| ).

  ENDLOOP.

  " Create stream
  go_ixml_ostream = go_ixml_sf->create_ostream_xstring( gv_xstring ).
  go_ixml_docu->render( go_ixml_ostream ).

ENDFORM.
*&---------------------------------------------------------------------*
*& Form design_mode
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM design_mode .

**********************************************************************
* Chart type : Only Columns and Lines
**********************************************************************
  DATA: l_win_chart   TYPE REF TO cl_gui_chart_engine_win,
        g_design_mode.

  CATCH SYSTEM-EXCEPTIONS move_cast_error = 1.
    l_win_chart ?= go_chart->get_control( ).
  ENDCATCH.

  IF sy-subrc IS INITIAL.

    l_win_chart->set_design_mode( flag = g_design_mode event = 'X' ).
*    l_win_chart->restrict_chart_types( charttypes = 'Columns' ).
    l_win_chart->restrict_chart_types( charttypes = 'Lines' ).
    l_win_chart->restrict_property_events( events = 'ChartType' ).

  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form set_gl_name
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM set_gl_name .



ENDFORM.
*&---------------------------------------------------------------------*
*& Form set_itab_value
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM set_itab_value USING pv_payment_term TYPE i.

  DATA: lv_txt50(10),
        lv_diff      TYPE p,
        lv_days      TYPE numc2,
        lt_sum_wrbtr TYPE wrbtr,
        gs_04        TYPE zc103sdt0004.

  lv_days = |{ pv_payment_term WIDTH = 2 PAD = '0' }|.  " pv_payment_term 숫자를 2자리 문자로 변환



  LOOP AT gt_header INTO gs_header.

*-- 2. 마감일자 채우기 (gs_header-endat)
    SELECT SINGLE billing_date total_amount
  INTO CORRESPONDING FIELDS OF gs_04
  FROM zc103sdt0004
 WHERE gjahr = gs_header-gjahr
   AND belnr = gs_header-belnr.

    IF  sy-subrc <> 0 OR gs_04-billing_date IS INITIAL.
      DELETE gt_header WHERE bukrs = gs_header-bukrs AND belnr = gs_header-belnr AND gjahr = gs_header-gjahr.
      CONTINUE.
    ENDIF.

    CALL FUNCTION 'RP_CALC_DATE_IN_INTERVAL'
      EXPORTING
        date      = gs_04-billing_date
        days      = lv_days
        months    = '00'
        signum    = '+'
        years     = '00'
      IMPORTING
        calc_date = gs_header-endat.

*-- 3. 연채일수 채우기 (overdue)
    CALL FUNCTION 'SD_DATETIME_DIFFERENCE'
      EXPORTING
        date1    = sy-datum
        time1    = '100000'
        date2    = gs_header-endat
        time2    = '100000'
      IMPORTING
        datediff = gs_header-overdue.

    " 4. 마감일자가 지나지 않은 데이터는 보여줄 필요 없으니 삭제
    IF gs_header-endat > sy-datum.
      DELETE gt_header WHERE bukrs = gs_header-bukrs AND belnr = gs_header-belnr AND gjahr = gs_header-gjahr.
      CONTINUE.
    ENDIF.

    "금액 채우기 ~
    gs_header-wrbtr = gs_04-total_amount.
    gs_header-budat = gs_04-billing_date.
    IF gs_header-budat IS INITIAL.
      DELETE gt_header WHERE bukrs = gs_header-bukrs AND belnr = gs_header-belnr AND gjahr = gs_header-gjahr.
      CONTINUE.
    ENDIF.

    " 5. 업데이트 ~
    MODIFY gt_header FROM gs_header.

  ENDLOOP.


ENDFORM.
*&---------------------------------------------------------------------*
*& Form get_itab
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM get_itab USING pv_bpid.

  DATA: lv_index   TYPE sy-tabix.

  IF pv_bpid IS INITIAL.
    " 2. gt_header 데이터 읽기
    SELECT bukrs gjahr belnr budat bktxt waers bp_name
      INTO CORRESPONDING FIELDS OF TABLE gt_header
      FROM zc103fit0001
      WHERE bukrs = '0001'
      AND   blart = 'DR'
      AND   bstat = 'A'
    ORDER BY gjahr belnr.
  ELSE.
    " 2. gt_header 데이터 읽기
    SELECT bukrs gjahr belnr budat bktxt waers bp_name
      INTO CORRESPONDING FIELDS OF TABLE gt_header
      FROM zc103fit0001
      WHERE bukrs = '0001'
      AND   blart = 'DR'
      AND   bstat = 'A'
    AND bp_id = pv_bpid
    ORDER BY gjahr belnr.
  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form create_ticket_html
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*&      <-- LT_HTML
*&---------------------------------------------------------------------*
FORM create_ticket_html  CHANGING pt_html TYPE STANDARD TABLE.

  DATA : lv_logo_b64 TYPE string.
  DATA: lv_wrbtr_text TYPE char20,
        lv_total      TYPE wrbtr,
        lv_total_text TYPE char20.

  DATA: lv_budat_formatted TYPE string,
        lv_endat_formatted TYPE string.

  DATA: lv_budat TYPE d,
        lv_endat TYPE d.

  DATA: lv_send_date_formatted TYPE string,
        lv_send_date           TYPE d.

  lv_send_date = sy-datum.
  lv_send_date_formatted = |{ lv_send_date+0(4) }-{ lv_send_date+4(2) }-{ lv_send_date+6(2) }|.

  lv_budat = gs_header-budat.
  lv_endat = gs_header-endat.

  lv_budat_formatted = |{ lv_budat+0(4) }-{ lv_budat+4(2) }-{ lv_budat+6(2) }|.
  lv_endat_formatted = |{ lv_endat+0(4) }-{ lv_endat+4(2) }-{ lv_endat+6(2) }|.

  PERFORM get_image CHANGING lv_logo_b64.

*  APPEND '<!DOCTYPE html>' TO pt_html.
*  APPEND '<html lang="ko">' TO pt_html.
*  APPEND '<head>' TO pt_html.
*  APPEND '<meta charset="UTF-8">' TO pt_html.
  APPEND '<!DOCTYPE html>' TO pt_html.
  APPEND '<html lang="ko">' TO pt_html.
  APPEND '<head>' TO pt_html.
  APPEND '<meta charset="UTF-8">' TO pt_html.
  APPEND '<style>' TO pt_html.
  APPEND '<title>독촉장</title>' TO pt_html.
  APPEND '<style>' TO pt_html.

  APPEND 'body { font-family: "Noto Sans KR", sans-serif; margin: 40px; color: #333; background-color: #f9f9f9; }' TO pt_html.
  APPEND '.container { background: #fff; padding: 40px; border-radius: 12px; box-shadow: 0 0 10px rgba(0,0,0,0.1); max-width: 800px; margin: auto; }' TO pt_html.
  APPEND '.header { text-align: center; margin-bottom: 40px; }' TO pt_html.
  APPEND '.header h1 { font-size: 28px; margin-bottom: 10px; }' TO pt_html.
  APPEND '.info-table, .content { margin-top: 20px; }' TO pt_html.
  APPEND '.info-table table { width: 100%; border-collapse: collapse; }' TO pt_html.
  APPEND '.info-table th, .info-table td { text-align: left; padding: 10px; border-bottom: 1px solid #ddd; }' TO pt_html.
  APPEND '.content p { margin: 10px 0; }' TO pt_html.
  APPEND '.signature { margin-top: 50px; }' TO pt_html.
  APPEND '.footer { text-align: center; font-size: 12px; margin-top: 40px; color: #777; }' TO pt_html.

  APPEND '</style>' TO pt_html.
  APPEND '</head>' TO pt_html.
  APPEND '<body>' TO pt_html.
  APPEND '<div class="container">' TO pt_html.

  APPEND '<div class="header">' TO pt_html.
  APPEND |<img src="data:image/png;base64,{ lv_logo_b64 }" alt="S-AIR" class="logo">| TO pt_html.
  APPEND '<h1>지급 요청 독촉장</h1>' TO pt_html.
*  APPEND '<p><strong>[회사명]</strong>삼만리항공 | [회사 주소] 종로 | [연락처] 02-2020-1313'  TO pt_html.
  APPEND '</div>' TO pt_html.

  APPEND '<div class="info-table"><table>' TO pt_html.
  APPEND |<tr><th>수신처:</th><td>{ gs_header-bp_name }</td></tr>| TO pt_html.
  APPEND |<tr><th>발송일자:</th><td>{ lv_send_date_formatted }</td></tr>| TO pt_html.
  APPEND '</table></div>' TO pt_html.

  APPEND '<div class="content">' TO pt_html.
  APPEND |<p>{ gs_header-bp_name } 귀사께,</p>| TO pt_html.
  APPEND '<p>당사는 아래 명세된 금액이 기한 내에 결제되지 않았음을 확인하였습니다. 귀사의 신속한 결제 처리를 부탁드립니다.</p>' TO pt_html.
  APPEND '<p><strong>미결제 내역:</strong></p>' TO pt_html.
  APPEND '<ul>' TO pt_html.

  CLEAR: lv_total, lv_total_text.
  CLEAR: lv_total, lv_total_text.
  LOOP AT gt_header INTO gs_header.
    CLEAR: lv_wrbtr_text, lv_budat_formatted, lv_endat_formatted.

    WRITE gs_header-wrbtr TO lv_wrbtr_text CURRENCY 'KRW'.

    lv_budat = gs_header-budat.
    lv_endat = gs_header-endat.

    lv_budat_formatted = |{ lv_budat+0(4) }-{ lv_budat+4(2) }-{ lv_budat+6(2) }|.
    lv_endat_formatted = |{ lv_endat+0(4) }-{ lv_endat+4(2) }-{ lv_endat+6(2) }|.

    APPEND |<li>빌링일자: { lv_budat_formatted }<span style="float:right;">₩{ lv_wrbtr_text }</span><br></li>| TO pt_html.
    APPEND |지급 요청 기한: { lv_endat_formatted }</li>| TO pt_html.

    lv_total = lv_total + gs_header-wrbtr.
  ENDLOOP.

  APPEND '</ul>' TO pt_html.
  WRITE lv_total TO lv_total_text CURRENCY 'KRW'.
  APPEND |<hr>| TO pt_html.
  APPEND |<p style="text-align: right;"><strong style="color:red;">총 미납 금액: { lv_total_text }</strong></p>| TO pt_html.

  APPEND '<p>문의 사항은 아래 연락처로 연락 주시기 바랍니다.</p>' TO pt_html.
*
*  APPEND '<div class="signature">' TO pt_html.
  APPEND '<p>감사합니다.</p>' TO pt_html.
  APPEND '<p><strong>삼만리항공</strong></p>' TO pt_html.

  APPEND '</div>' TO pt_html.
  APPEND '</body>' TO pt_html.
  APPEND '</html>' TO pt_html.


ENDFORM.
*&---------------------------------------------------------------------*
*& Form get_image
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*&      <-- LV_LOGO_B64
*&---------------------------------------------------------------------*
FORM get_image  CHANGING  pv_logo_b64 TYPE string.

  DATA: lt_data    TYPE STANDARD TABLE OF w3mime,
        lv_size    TYPE i,
        lv_xstring TYPE xstring.

  " 로고 이미지 HTML에 넣기 위해 인코딩
  CONCATENATE

  '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'
  INTO  pv_logo_b64.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form send_mail
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM send_mail .

  DATA: lv_subject      TYPE so_obj_des,
        lv_body_text    TYPE bcsy_text,
        lv_receiver     TYPE ad_smtpadr,
        lv_sender       TYPE REF TO cl_sapuser_bcs,
        lo_send_request TYPE REF TO cl_bcs,
        lo_document     TYPE REF TO cl_document_bcs,
        lo_recipient    TYPE REF TO if_recipient_bcs,
        lt_attachment   TYPE solix_tab,
        lv_size         TYPE i,
        lv_file_name    TYPE so_obj_des,    " 파일 이름
        lv_html_path    TYPE string,        " html파일 경로
        lv_pdf_path     TYPE string,        " pdf 파일 경로
        lv_cmd          TYPE string,
        lv_usname       TYPE zc103fit0001-usname,
        lv_uscode       TYPE zc103fit0001-uscode,
        lv_answer,
        lv_dunning_date TYPE zc103e_sd_dunning_date,
        lv_count        TYPE i,
        lv_bpid         TYPE zc103sdt0001-bpid.

  DATA: lt_html TYPE STANDARD TABLE OF string.

  SELECT SINGLE bpid
    INTO lv_bpid
    FROM zc103sdt0001
    WHERE bpname = gv_selected_bpname.

  SELECT COUNT(*)
    FROM zc103fit0020
    WHERE bp_id = @lv_bpid
      AND belnr IS INITIAL
    INTO @lv_count.

*  IF lv_count > 0.
*    MESSAGE '반제처리가 되지 않은 입금내역이 있습니다. 반제부터 진행해주세요.' TYPE 'S' DISPLAY LIKE 'E'.
*    RETURN.
*  ENDIF.

  IF gt_header IS INITIAL.
    MESSAGE '독촉할 데이터가 없습니다' TYPE 'S' DISPLAY LIKE 'E'.
    RETURN.
  ENDIF.

  SELECT SINGLE dunning_date
    INTO lv_dunning_date
    FROM zc103sdt0016
    WHERE bpname = gv_selected_bpname.

  IF lv_dunning_date IS NOT INITIAL.
    CALL FUNCTION 'ZC1F030001'
      EXPORTING
        iv_action = '마지막 독촉일자: ' && lv_dunning_date && ' 독촉'
      IMPORTING
        ev_answer = lv_answer.

    IF lv_answer = '2'.  " No를 선택하면 종료
      RETURN.
    ENDIF.

  ENDIF.

  CALL FUNCTION 'ZC103PMFG0005'
    IMPORTING
      empno   = lv_uscode
      empname = lv_usname.

  IF lv_usname IS INITIAL.
    MESSAGE '사용자가 취소했습니다.' TYPE 'S' DISPLAY LIKE 'E'.
    RETURN.
  ENDIF.

  " 0. HTML 생성 (항상 최신 내용으로)
  PERFORM create_ticket_html CHANGING lt_html.

  " 1. HTML 파일로 저장
  CALL METHOD cl_gui_frontend_services=>gui_download
    EXPORTING
      filename = lv_html_path
      filetype = 'ASC'
    CHANGING
      data_tab = lt_html
    EXCEPTIONS
      OTHERS   = 1.
  IF sy-subrc <> 0.
    MESSAGE 'HTML 파일 생성 실패' TYPE 'E'.
    RETURN.
  ENDIF.

  " 0. 파일명, 경로 등 세팅
  READ TABLE gt_header INTO gs_header INDEX 1.
  lv_file_name = |E-Ticket_{ gs_header-bp_id }_{ sy-datum }|.
  lv_html_path = |C:/Users/soldesk/Desktop/tickets/E-ticket_{ gs_header-bp_id }_{ sy-datum }.html|.
  lv_pdf_path = |C:/Users/soldesk/Desktop/tickets/E-ticket_{ gs_header-bp_id }_{ sy-datum }.html.pdf|.

  " 1. 파일을 바이너리로 불러오기
  CALL METHOD cl_gui_frontend_services=>gui_upload
    EXPORTING
      filename                = lv_html_path
      filetype                = 'BIN'
    IMPORTING
      filelength              = lv_size
    CHANGING
      data_tab                = lt_attachment
    EXCEPTIONS
      file_open_error         = 1
      file_read_error         = 2
      no_batch                = 3
      gui_refuse_filetransfer = 4
      invalid_type            = 5
      no_authority            = 6
      unknown_error           = 7
      OTHERS                  = 8.

  CASE sy-subrc.
    WHEN 0.
      " 정상 처리
    WHEN OTHERS.
      MESSAGE |파일 업로드 실패! 경로 확인: { lv_html_path }| TYPE 'E'.
      EXIT.
  ENDCASE.

* 2. 메일 객체 생성
  lo_send_request = cl_bcs=>create_persistent( ).

* 3. 본문 작성
  lv_subject = |[SAIR] { gs_header-bp_name }님의 삼만리항공 독촉장|.
  APPEND '삼만리항공입니다. 첨부파일 확인 부탁드립니다.' TO lv_body_text.
  lo_document = cl_document_bcs=>create_document(
    i_type    = 'RAW'
    i_text    = lv_body_text
    i_subject = lv_subject ).

* 4. 첨부 추가
  CALL METHOD lo_document->add_attachment
    EXPORTING
      i_attachment_type    = 'htm'
      i_attachment_subject = lv_file_name
      i_att_content_hex    = lt_attachment.

* 5. 문서 첨부
  CALL METHOD lo_send_request->set_document( lo_document ).

* 6. 수신자 지정
  lv_receiver = |{ 'ghkwlsspdl@naver.com' }|.
  lo_recipient = cl_cam_address_bcs=>create_internet_address( lv_receiver ).
  CALL METHOD lo_send_request->add_recipient
    EXPORTING
      i_recipient = lo_recipient
      i_express   = 'X'.

* 7. 보내기
  CALL METHOD lo_send_request->send(
    EXPORTING
      i_with_error_screen = 'X'
    RECEIVING
      result              = DATA(lv_result) ).

  COMMIT WORK.

  IF lv_result = 'X'.

    DATA: lv_today TYPE sy-datum.
    lv_today = sy-datum.

    UPDATE zc103sdt0016
      SET dunning_date = sy-datum
    WHERE bpname = gv_selected_bpname.
    MESSAGE '메일 전송 성공' TYPE 'S'.
  ELSE.
    MESSAGE '메일 전송 실패' TYPE 'S' DISPLAY LIKE 'E'.
  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form display_popup_screen
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM display_popup_screen .

  DATA : ls_variant TYPE disvariant,
         ls_layout  TYPE lvc_s_layo.

  IF go_item_popup_container IS NOT BOUND.

    CLEAR : gt_pfcat.
    PERFORM set_popup_field_catalog USING : 'X' 'BUKRS' 'ZC103FIT0002' 'C' ' ', " 회사코드
                                            'X' 'BELNR' 'ZC103FIT0002' 'C' ' ', " 전표번호
                                            'X' 'GJAHR' 'ZC103FIT0002' 'C' ' ', " 회계연도
                                            'X' 'BUZEI' 'ZC103FIT0002' 'C' ' ', " 항목번호
                                            ' ' 'SHKZG' 'ZC103FIT0002' 'C' ' ', " 차/대 지시자
                                            ' ' 'HKONT' 'ZC103FIT0002' 'C' ' ', " 계정번호
                                            ' ' 'TXT50' 'ZC103FIT0003' '' ' ', " 계정이름
                                            ' ' 'SGTXT' 'ZC103FIT0002' '' ' ', " 계정이름
                                            ' ' 'WRBTR' 'ZC103FIT0002' ' ' ' ', " 전표통화금액
                                            ' ' 'K_WAERS' 'ZC103FIT0002' 'C' 'X'. " 통화키
    PERFORM create_popup_object.

    ls_variant-report = sy-repid.
    ls_variant-handle = 'POP1'.

    ls_layout-zebra       = abap_true.
    ls_layout-cwidth_opt  = 'A'.
    ls_layout-sel_mode    = 'D'.
    ls_layout-no_toolbar  = abap_true. " Hide all toolbar of ALV

    CALL METHOD go_item_alv_grid->set_table_for_first_display
      EXPORTING
        is_variant      = ls_variant
        i_save          = 'A'
        i_default       = 'X'
        is_layout       = ls_layout
      CHANGING
        it_outtab       = gt_item
        it_fieldcatalog = gt_pfcat.

  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form set_popup_field_catalog
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*&      --> P_
*&      --> P_
*&      --> P_
*&      --> P_
*&      --> P_
*&---------------------------------------------------------------------*
FORM set_popup_field_catalog  USING pv_key pv_field pv_table pv_just pv_emph.

  gs_pfcat-key        = pv_key.
  gs_pfcat-fieldname  = pv_field.
  gs_pfcat-ref_table  = pv_table.
  gs_pfcat-just       = pv_just.
  gs_pfcat-emphasize  = pv_emph.

  CASE pv_field.
    WHEN 'WRBTR'.
      gs_pfcat-cfieldname = 'K_WAERS'.
      gs_pfcat-coltext = '전표통화금액'.
    WHEN 'BUKRS'.
      gs_pfcat-coltext = '회사코드'.
    WHEN 'GJAHR'.
      gs_pfcat-coltext = '회계년도'.
    WHEN 'BELNR'.
      gs_pfcat-coltext = '전표번호'.
    WHEN 'BUZEI'.
      gs_pfcat-coltext = '아이템번호'.
    WHEN 'SHKZG'.
      gs_pfcat-coltext = '차대지시자'.
    WHEN 'K_WAERS'.
      gs_pfcat-coltext = '전표통화'.
    WHEN 'HKONT'.
      gs_pfcat-coltext = '계정번호'.
    WHEN 'TXT50'.
      gs_pfcat-coltext = '계정이름'.
    WHEN 'SGTXT'.
      gs_pfcat-coltext = '아이템적요'.

  ENDCASE.

  APPEND gs_pfcat TO gt_pfcat.
  CLEAR gs_pfcat.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form create_popup_object
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM create_popup_object .

  CREATE OBJECT go_item_popup_container
    EXPORTING
      container_name = 'POP_CONT'.

  CREATE OBJECT go_item_alv_grid
    EXPORTING
      i_parent = go_item_popup_container.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form display_html_screen
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM display_html_screen .

  DATA: lv_url       TYPE c LENGTH 255.

  lv_url = gv_html_url.

*
*  IF go_popup_html_cont IS INITIAL.
*
*    CREATE OBJECT go_popup_html_cont
*      EXPORTING
*        container_name = 'MAIN'.
*
*    CREATE OBJECT go_html_view
*      EXPORTING
*        parent = go_popup_html_cont.
*
*    CALL METHOD go_html_view->show_url
*      EXPORTING
*        url = lv_url.
*  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form close
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM close .

  IF go_html_view IS BOUND.
    CALL METHOD go_html_view->free.
    FREE go_html_view.
  ENDIF.

  IF go_popup_container IS BOUND.
    CALL METHOD go_popup_container->free.
    FREE go_popup_container.
  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form goto_clearing_program
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM goto_clearing_program .

  SET PARAMETER ID 'PRC' FIELD 'X'.
  CALL TRANSACTION 'ZC103FIR0004' AND SKIP FIRST SCREEN.

ENDFORM.

----------------------------------------------------------------------------------
Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 758
